webpackJsonp([0,1],[function(t,e,n){"use strict";var r=VFDeps.State,o=VFDeps.Collection,i=n(11);n(16),n(19),n(18),n(17);var s=r.extend({mappable:{source:["frametime","midi","firstframetime","signals"],target:["layers","signals"]},props:{},session:{audio:["object",!0,function(){return{bufferLength:128,frequency:new Uint8Array(128),timeDomain:new Uint8Array(128)}}],midi:"state",frametime:["number",!0,0],firstframetime:["any",!0,function(){return performance.now()}],latency:["number",!0,0]},collections:{layers:o.extend({comparator:"zIndex",mainIndex:"name",model:function(t,e){var n=i[t.type]||i,r=new n(t,e);return r.on("change",function(){e.collection.trigger("change:layer",r)}),r}}),signals:n(21)},toJSON:function(){var t=r.prototype.toJSON.apply(this,arguments);return delete t.audio,t}});t.exports=s},,,function(t,e,n){"use strict";var r=window.VFDeps.View,o=n(45),i=r.extend({template:'<section class="rows signal"><header class="row"><h3 class="row name"></h3></header><div class="row gutter-horizontal columns test text-center"><input class="column input" placeholder="Input" type="text"/><div class="column gutter-horizontal no-grow">&raquo;</div><div class="column result"></div></div></section>',session:{input:"any",showMappings:["boolean",!0,!1]},derived:{result:{deps:["input","model","model.transformations"],fn:function(){return this.model.computeSignal(this.input)}}},bindings:{"model.name":".name",result:".test .result"},events:{"change .test .input":"_testValue","click header h3":"_showDetails"},_showDetails:function(){this.rootView.showDetails(new o({parent:this,model:this.model}))},_testValue:function(t){this.input=t.target.value.trim()},render:function(){this.renderWithTemplate();var t=this.query(".test .input");return t&&!t.value&&(t.value=this.input||null),this}});i.types={},t.exports=i},function(t,e,n){"use strict";var r=window.VFDeps.assign,o=n(3),i=o.types.hslaSignal=o.extend({template:['<section class="rows signal signal-color">','<header class="row">','<h3 class="name"></h3>',"</header>",'<div class="row columns gutter-horizontal gutter-bottom">','<div class="column result-color no-grow"></div>','<div class="column result gutter-left"></div>',"</div>",'<div class="row mappings props"></div>',"</section>"].join(""),bindings:r({},o.prototype.bindings,{"model.result":[{selector:".result-color",type:function(t,e){t.style.backgroundColor=e}},{selector:".result",type:"text"}]})});t.exports=i},function(t,e,n){"use strict";function r(t,e){var n=u||{};if(n[t]&&n[t][e])return n[t][e]||function(){}}function o(t,e){var n=i(function(t,n){e.set(t,n)},62.5),o=r(e.manufacturer,e.name);return function(t){if(e.active){var r=o(t.data);r.name&&n(r.name,r.velocity)}}}var i=VFDeps.throttle,s=VFDeps.State,a=VFDeps.Collection,u={"KORG INC.":{"KP3 MIDI 1":n(42),"nanoKONTROL2 MIDI 1":n(43)},"AKAI professional LLC":{"LPD8 MIDI 1":n(41)},"Focusrite A.E. Ltd":{"Launchpad Mini MIDI 1":n(44)}},c=s.extend({props:{manufacturer:"string",name:"string"},session:{active:["boolean",!0,!0],connection:"string",state:"string",type:"string",id:"string",version:"string"}}),l=s.extend({mappable:{source:["inputs"],target:[]},registerInput:function(t){var e=r(t.manufacturer,t.name);if(!e)return void("Midi Through Port-0"!==t.name&&console.warn("Unrecognized MIDI controller %s from %s",t.name,t.manufacturer));var n={},i=[];Object.keys(e.note||{}).forEach(function(t){i.push(e.note[t]),n[e.note[t]]=["number",!0,0]});var s=c.extend({mappable:{source:i,target:[]},props:n}),a=new s({connection:t.connection,state:t.state,type:t.type,id:e.prefix,manufacturer:t.manufacturer,name:t.name,version:t.version});"undefined"!=typeof t.onmidimessage&&(t.onmidimessage=o(this,a)),this.inputs.add(a)},initialize:function(t){function e(){return n.MIDIAccess?(n.inputs.reset(),n.MIDIAccess.inputs.forEach(n.registerInput,n),void n.trigger("change:inputs")):void n.inputs.reset([])}t=t||{};var n=this;if(n.on("change:MIDIAccess",e),"undefined"==typeof t.MIDIAccess){if(!navigator.requestMIDIAccess)return console.warn("No WebMIDI API support"),void(n.MIDIAccess=!1);navigator.requestMIDIAccess().then(function(t){n.MIDIAccess=t,n.MIDIAccess.onstatechange=function(t){n.MIDIAccess=t.currentTarget,e()}},function(){n.MIDIAccess=!1})}},session:{MIDIAccess:{type:"any",default:!1}},collections:{inputs:a.extend({})},toJSON:function(){var t={};return t.inputs=this.inputs.toJSON(),t}});t.exports=l},function(t,e,n){"use strict";var r=window.VFDeps,o=r.View,i=o.extend({template:['<li class="gutter">','<span class="name"></span> ',"</li>"].join(""),bindings:{"model.active":{type:"booleanClass"},"model.state":".state","model.name":".name"},events:{click:"_handleClick"},_handleClick:function(){this.model.toggle("active")}}),s=o.extend({template:'<div class="midi-access"><div class="midi-inputs"><div class="gutter">Inputs</div><ul></ul></div></div>',render:function(){var t;return this.el&&(t=this.el.className),this.renderWithTemplate(),t&&(this.el.className=t),this.inputsView=this.renderCollection(this.model.inputs,i,".midi-inputs ul"),this}});t.exports=s},function(t,e,n){"use strict";var r=VFDeps.assign,o=n(3),i=o.types.beatSignal=o.extend({template:'<section class="rows signal signal-beat"><header class="row"><h3 class="name"></h3></header><div class="detector"><button class="avg">Tap</button></div><div class="row columns gutter-horizontal gutter-bottom"><div class="column result-dot no-grow gutter-right"></div><div class="column result gutter-left"><input class="column input" placeholder="BPM" data-hook="input" /></div></div><div class="row mappings props"></div></section>',bindings:r({},o.prototype.bindings,{avg:{type:"text",selector:".avg"},"model.input":{type:"value",hook:"input"},"model.result":[{selector:".result-dot",type:function(t,e){t.style.backgroundColor="hsla(190, 81%, 67%,"+e/100+")"}}]}),events:r({},o.prototype.events,{"click .detector > button":"tap","change [data-hook=input]":"_updateBPM"}),_updateBPM:function(){this.model.input=parseInt(this.queryByHook("input").value.trim(),10)},session:{wait:["number",!0,2],avg:["number",!0,0],count:["number",!0,0],first:["number",!0,0],previous:["number",!0,0]},_resetDetector:function(){this.set({count:0,first:0,previous:0})},tap:function(){var t=new Date,e=t.getTime(),n=2;e-this.previous>1e3*n&&(this.count=0),this.count?(this.avg=Math.round(6e4*this.count/(e-this.first)*100)/100,this.count++):(this.first=e,this.count=1),this.model.input=this.avg,this.previous=e}});t.exports=i},function(t,e,n){"use strict";var r=n(3),o=n(4),i=r.types.rgbaSignal=o.extend({});t.exports=i},,,function(t,e,n){"use strict";var r=VFDeps.State,o=r.extend({idAttribute:"name",typeAttribute:"type",props:{active:["boolean",!0,!0],mixBlendMode:{type:"string",default:"normal",required:!0,values:["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color"]},name:["string",!0,null],opacity:{type:"number",default:100},rotateX:{type:"number",default:0},rotateY:{type:"number",default:0},rotateZ:{type:"number",default:0},translateX:{type:"number",default:0},translateY:{type:"number",default:0},scaleX:{type:"number",default:100},scaleY:{type:"number",default:100},skewX:{type:"number",required:!1,default:0},skewY:{type:"number",required:!1,default:0},type:["string",!0,"default"],zIndex:["number",!0,0]},session:{uiState:{type:"string",values:["","dependency","dependent","focus","highlighted"],default:"",required:!0}},serialize:function(){var t=r.prototype.serialize.apply(this,arguments);return delete t.uiState,t},derived:{mappable:{deps:[],fn:function(){var t=this.constructor.prototype,e=Object.keys(t._definition||{}).concat(Object.keys(t._children||{}),Object.keys(t._collections||{})).filter(function(t){return t!==this.idAttribute&&t!==this.typeAttribute&&"uiState"!==t},this);return{source:[],target:e}}}}});t.exports=o},function(t,e,n){!function(e){"use strict";var r=e.VFDeps.State,o=e.VFDeps.Collection,i=n(14),s=r.extend({props:{name:["string",!0,null],arguments:["array",!0,function(){return[]}]}}),a=r.extend({idAttribute:"name",typeAttribute:"type",initialize:function(){this.on("change:result",function(){this.collection.parent.trigger(this.name,this.result)}),null!==this.input&&void 0!==this.input||(this.input=this.defaultValue)},mappable:{source:["result"],target:["input"]},props:{name:["string",!0,null],type:["string",!0,"default"],defaultValue:["any",!0,function(){return 1}],input:["any",!1,null]},session:{uiState:{type:"string",values:["","dependency","dependent","focus","highlighted"],default:"",required:!0}},collections:{transformations:o.extend({model:s})},derived:{result:{deps:["input","transformations"],fn:function(){return this.computeSignal()}}},computeSignal:function(t){return t=t||this.input,this.transformations.forEach(function(e){var n=[t].concat(e.arguments);t=i[e.name].apply(this,n)}),t}});a.types={},t.exports=a}("undefined"!=typeof window?window:self)},,function(t,e,n){"use strict";var r={};r["math.multiply"]=function(t,e){return t*e},r["math.add"]=function(t,e){return t+e},r["math.subtract"]=function(t,e){return t-e},r["math.modulo"]=function(t,e){return t%e},r["math.above"]=function(t,e){return t>e},r["math.aboveOrEqual"]=function(t,e){return t>=e},r["math.below"]=function(t,e){return t<e},r["math.belowOrEqual"]=function(t,e){return t<=e},r["math.within"]=function(t,e,n){return t<=n&&t>=e},Object.getOwnPropertyNames(Math).forEach(function(t){"constructor"!==t&&"function"==typeof Math[t]&&(r["math."+t]=Math[t])});var o="".constructor.prototype;Object.getOwnPropertyNames(o).forEach(function(t){"constructor"!==t&&"function"==typeof o[t]&&(r["string."+t]=function(e){var n=[].slice.apply(arguments).slice(1);o[t].apply(e,n)})}),r["string.toBool"]=function(t){return!(!t||"false"===t||"null"===t)},r["string.toInteger"]=function(t){return parseInt(t,10)},r["string.toFloat"]=function(t){return parseFloat(t)},r["string.toNumber"]=function(t){return Number(t)},t.exports=r},function(t,e,n){"use strict";var r=n(25),o=VFDeps.assign,i=VFDeps.Collection,s=VFDeps.State,a=VFDeps.View,u=a.extend({template:'<div class="columns object-prop prop-type-default"><div class="column gutter text-right prop-name"></div><div class="column no-grow prop-value-reset"><button class="vfi-cancel"></button></div><div class="column prop-value"><input name="value" type="text" /></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',initialize:function(){var t=this._handleChange.bind(this);this.on("change:el",function(){this.previousAttributes.el&&this.previousAttributes.el.removeEventListener("change",t,{passive:!0}),this.el&&this.el.addEventListener("change",t,{passive:!0})}),this.listenTo(this.parent.model,"all",function(t){t==="change:"+this.model.name&&this.trigger("change:parent.model")})},derived:{suggestionHelper:{cache:!1,fn:function(){for(var t=this.parent;t;){if(t.suggestionHelper)return t.suggestionHelper;t=t.parent}return!1}},value:{deps:["model","model.name","parent.model"],fn:function(){return this.parent.model.get(this.model.name)}},mappingPath:{deps:["value"],fn:function(){return r.objectPath(this.parent.model)+this.model.name}},mappingObject:{deps:["value"],fn:function(){return r.isTarget(this.parent.model,this.model.name)}}},bindings:{"model.name":{type:"text",selector:".prop-name"},value:{type:function(t,e){t!==document.activeElement&&(t.value=e)},selector:"input[name=value]"},mappingObject:{type:"booleanAttribute",selector:".prop-mapping-clear button",name:"disabled",invert:!0}},events:{"click .prop-value-reset button":"_handleReset","change [name=mapping]":"_handleMappingChange","focus [type=text][name=value]":"_suggestValues","focus [name=mapping]":"_suggestMappings"},_handleReset:function(){this.parent.model.unset(this.model.name)},_handleMappingChange:function(){console.info("_handleMappingChange")},_suggestValues:function(t){var e=this.suggestionHelper;if(e&&this.model.values&&this.model.values.length){var n=this.model,r=t.target;e.attach(r,function(t){n.collection.parent.set(n.name,t),r.value=t,e.detach()}).fill(this.model.values)}},_suggestMappings:function(t){console.info("_suggestMappings",this.model.values,t.target,t.delegatedTarget)},_handleChange:function(){}});u.types={},u.types.boolean=u.extend({template:'<div class="columns object-prop prop-type-boolean"><div class="column gutter text-right prop-name"></div><div class="column no-grow"><button class="vfi-cancel"></button></div><div class="column prop-value"><button class="prop-toggle-btn"></button></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',bindings:o({},u.prototype.bindings,{value:{selector:"button.prop-toggle-btn",type:"booleanClass",yes:"vfi-toggle-on",no:"vfi-toggle-off"}}),events:{"click button.prop-toggle-btn":"_handleToggle"},_handleChange:function(){},_handleToggle:function(){this.parent.model.toggle(this.model.name)}}),u.types.number=u.extend({template:'<div class="columns object-prop prop-type-number"><div class="column gutter text-right prop-name"></div><div class="column no-grow"><button class="vfi-cancel"></button></div><div class="column prop-value"><input name="value" type="number" /></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',bindings:o({},u.prototype.bindings,{min:[{selector:"[name=value]",type:function(t,e){null!==e&&"undefined"!=typeof e?t.setAttribute("min",e):t.removeAttribute("min")}}],max:[{selector:"[name=value]",type:function(t,e){null!==e&&"undefined"!=typeof e?t.setAttribute("max",e):t.removeAttribute("max")}}]}),session:{min:["number",!1,null],max:["number",!1,null]},_handleChange:function(t){}}),u.names={},u.names.active=u.types.boolean.extend({}),u.names.opacity=u.types.number.extend({session:{min:["number",!1,0],max:["number",!1,100]}}),u.names.skewX=u.names.skewY=u.names.rotateX=u.names.rotateY=u.names.rotateZ=u.types.number.extend({session:{min:["number",!1,-360],max:["number",!1,360]}});var c=a.extend({template:'<section class="row rows"><header class="row no-grow"><h3>Details for <span data-hook="name"></span></h3><h5 data-hook="object-path"></h5></header><div class="row items"></div></section>',initialize:function(){this.listenToAndRun(this,"change:definition",function(){this.properties.reset(this.definition)})},derived:{propNames:{deps:["model"],fn:function(){var t=this.model.constructor.prototype._definition;return Object.keys(t).filter(function(t){return["drawFunction","uiState","name","type","zIndex"].indexOf(t)<0})}},definition:{deps:["propNames"],fn:function(){var t=this.model.constructor.prototype._definition;return this.propNames.map(function(e){return o({name:e},t[e])})}},objectPath:{deps:["model"],fn:function(){return r.objectPath(this.model)}}},collections:{properties:i.extend({mainIndex:"name",model:s.extend({idAttribute:"name",session:{name:"string",allowNull:"boolean",default:"any",required:"boolean",test:"any",type:"string",values:"array"}})})},subviews:{propertiesView:{waitFor:"el",selector:".items",prepareView:function(t){return this.renderCollection(this.properties,function(t){var e=u.names[t.model.name]||u.types[t.model.type]||u;return new e(t)},t)}}},bindings:{"model.uiState":{selector:"header",type:"class"},"model.name":"[data-hook=name]",objectPath:'[data-hook="object-path"]'}});t.exports=c},function(module,exports,__webpack_require__){"use strict";var State=VFDeps.State,Collection=VFDeps.Collection,ScreenLayerState=__webpack_require__(11),CanvasLayer=State.extend({idAttribute:"name",initialize:function(){State.prototype.initialize.apply(this,arguments);var t=this,e=t.collection.parent;t.on("change",function(){e._changed={canvasLayers:e.canvasLayers.serialize()},e.trigger("change")})},cache:{},props:{duration:["number",!0,1e3],fps:["number",!0,16],weight:["number",!0,0],name:["string",!0,null],active:["boolean",!0,!0],opacity:["number",!0,100],blending:{type:"string",required:!0,default:"source-over",values:["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","copy","xor"]},drawFunction:"any"},session:{uiState:{type:"string",values:["","dependency","dependent","focus","highlighted"],default:"",required:!0}},serialize:function(){var t,e=State.prototype.serialize.apply(this,arguments),n={},r=this.serializationProps.props||[];r.length&&(n.props={});var o=this.constructor.prototype._definition;for(t in e)n[t]=e[t],r.indexOf(t)>-1&&(n.props[t]=o[t]);var i=typeof this.drawFunction;return"function"===i?n.drawFunction=this.drawFunction.toString():"string"===i&&(n.drawFunction=this.drawFunction),n.name=this.name,delete n.uiState,n},derived:{mappable:{deps:ScreenLayerState.prototype._derived.mappable.deps,fn:function(){var t=ScreenLayerState.prototype._derived.mappable.fn.apply(this,arguments),e=t.target.filter(function(t){return["uiState","drawFunction","screenState","draw"].indexOf(t)<0});return{source:[],target:e}}},screenState:{deps:[],fn:function(){return this.collection.parent.collection.parent}},width:{deps:["screenState","screenState.width"],fn:function(){return this.screenState.width||400}},height:{deps:["screenState","screenState.height"],fn:function(){return this.screenState.height||300}},draw:{deps:["drawFunction"],fn:function(){var fn=this.drawFunction;if("string"==typeof fn)try{eval("fn = (function() { return "+this.drawFunction+"; })()")}catch(t){console.warn("draw function error",t)}return("function"==typeof fn?fn:function(){}).bind(this)}}}}),_CanvasLayersCache={},CanvasLayers=Collection.extend({mainIndex:CanvasLayer.prototype.idAttribute,comparator:"weight",model:function(t,e){var n={props:t.props||{},serializationProps:{props:[].concat(["active","blending","opacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY"],Object.keys(t.props||{}))}},r=_CanvasLayersCache[t.name]||CanvasLayer.extend(n);_CanvasLayersCache[t.name]=r;var o=new r(t,e);return o.on("change:weight",function(){o.collection.sort()}),e.init===!1&&o.initialize(),o}});module.exports=ScreenLayerState.canvas=ScreenLayerState.extend({collections:{canvasLayers:CanvasLayers}})},function(t,e,n){"use strict";var r=n(11);t.exports=r.img=r.extend({props:{src:["string",!0,null],backgroundSize:["string",!0,"cover"],backgroundPosition:["string",!0,"center"],backgroundRepeat:["string",!0,"no-repeat"]},initialize:function(){if(r.prototype.initialize.apply(this,arguments),!this.src)throw new Error("Missing src attribute for img layer")}})},function(t,e,n){"use strict";var r=n(11);t.exports=r.SVG=r.extend({props:{src:["string",!0,null],styles:["string",!0,""]},initialize:function(){if(r.prototype.initialize.apply(this,arguments),!this.src)throw new Error("Missing src attribute for SVG layer")}})},function(t,e,n){"use strict";var r=n(11);t.exports=r.video=r.extend({props:{src:["string",!0,null]},initialize:function(){if(r.prototype.initialize.apply(this,arguments),!this.src)throw new Error("Missing src attribute for video layer")}})},function(t,e,n){"use strict";var r=n(12),o=r.types.beatSignal=r.extend({session:{frametime:["number",!0,0]},mappable:{source:["result","timeBetweenBeats"],target:["input"]},derived:{result:{deps:["timeBetweenBeats","frametime"],fn:function(){return this.computeSignal()}},timeBetweenBeats:{deps:["input"],fn:function(){return 6e4/Math.max(this.input,1)}}},computeSignal:function(){var t=this.frametime,e=t?100-t%this.timeBetweenBeats/this.timeBetweenBeats*100:0,n=r.prototype.computeSignal.apply(this,[e]);return n}});t.exports=o},function(t,e,n){"use strict";var r=VFDeps.Collection,o=n(12);n(20),n(22),n(23);var i=r.extend({mainIndex:"name",model:function(t,e){var n=o.types[t.type]||o;return new n(t,e)}});t.exports=i},function(t,e,n){"use strict";var r=n(12),o={type:"number",required:!0,default:180,min:0,max:360},i={type:"number",required:!0,default:100,min:0,max:100},s=r.types.hslaSignal=r.extend({session:{hue:o,saturation:i,lightness:i,alpha:i},mappable:{source:["result","hue","saturation","lightness","alpha"],target:["hue","saturation","lightness","alpha"]},derived:{result:{deps:["hue","saturation","lightness","alpha"],fn:function(){return this.computeSignal()}}},computeSignal:function(){return"hsla("+Math.round(this.hue)+","+Math.round(this.saturation)+"%,"+Math.round(this.lightness)+"%,"+Math.round(this.alpha)/100+")"}});t.exports=s},function(t,e,n){"use strict";var r=n(12),o={type:"number",required:!0,default:180,min:0,max:255},i={type:"number",required:!0,default:100,min:0,max:100},s=r.types.rgbaSignal=r.extend({session:{red:o,green:o,blue:o,alpha:i},mappable:{source:["result","red","green","blue","alpha"],target:["red","green","blue","alpha"]},derived:{result:{deps:["red","green","blue","alpha"],fn:function(){return this.computeSignal()}}},computeSignal:function(){return"rgba("+Math.round(this.red)+","+Math.round(this.green)+","+Math.round(this.blue)+","+Math.round(this.alpha)/100+")"}});t.exports=s},,function(module,exports){!function(global){"use strict";function isCollectionOfParent(t,e){if(e&&e._collections)for(var n in e._collections)if(e[n]===t.collection)return n+"."+t.getId()}function isChildOfParent(t,e){if(e&&e._children)for(var n in e._children)if(e[n]===t)return n}function isPropOfParent(t,e){if(e)for(var n in e)if(e[n]===t)return n}function objectPath(t){if(!t)return null;var e=[],n=function(t){var r=t.collection?isCollectionOfParent(t,t.collection.parent):null;if(r)return e.unshift(r),n(t.collection.parent);var o=isChildOfParent(t,t.parent);if(o)return e.unshift(o),n(t.parent);var i=isPropOfParent(t,t.parent);return i?(e.unshift(i),n(t.parent)):void(t.parent&&n(t.parent))};return n(t),e.join(".")}function resolve(t,e){function n(t){var e=t.split("."),n=function(t){if(!e.length)return t;var r=e.shift();return t[r]&&t[r].isCollection?n(t[r].get(e.shift())):"undefined"!=typeof t[r]?n(t[r]):void 0};return n}if(!e)throw new Error("Missing context to solve mapping path");return n(t)(e)}var State=global.VFDeps.State,Collection=global.VFDeps.Collection,MappingState=State.extend({mappable:{source:[],target:[]},props:{sourceObject:["state",!0,null],sourceProperty:["string",!0,null],targetObject:["state",!1,null],targetProperty:["string",!1,null],transformation:["any",!1,null]},session:{uiState:{type:"string",values:["","dependency","dependent","focus","highlighted"],default:"",required:!0}},derived:{sourcePath:{deps:["sourceObject","sourceProperty"],fn:function(){var t=objectPath(this.sourceObject);return(t?t+".":"")+this.sourceProperty}},sourceValue:{deps:["sourceObject","sourceProperty"],fn:function(){return this.sourceObject.get(this.sourceProperty)}},sourceObjectType:{deps:["sourceValue"],fn:function(){return typeof this.sourceValue}},transformationFunction:{deps:["transformation"],fn:function(){var noop=function(t){return t},fn;if("function"==typeof this.transformation)fn=this.transformation.bind(this);else if("string"==typeof this.transformation)try{eval("fn = "+this.transformation+";")}catch(t){console.warn(t),fn=noop}else fn=noop;return fn}},targetPath:{deps:["targetObject","targetProperty"],fn:function(){if(!this.targetObject||!this.targetProperty)return null;var t=objectPath(this.targetObject);return(t?t+".":"")+this.targetProperty}},targetValue:{deps:["sourceValue","targetObject","targetProperty","transformationFunction"],fn:function(){return this.targetObject&&this.targetProperty?this.transformationFunction.call(this,this.sourceValue):null}}},objectPath:function(t){return objectPath(t)},resolve:function(t,e){return resolve(t,e||this.collection.context)},initialize:function(t){if(!t.sourceObject||!t.sourceProperty)throw new Error("Missing sourceObject information");this.listenToAndRun(this,"change:targetValue",this.sourceValueChange),this.listenToAndRun(this.sourceObject,"all",function(t){t==="change:"+this.sourceProperty&&this.trigger("change:sourceProperty")})},updateInfo:function(t,e,n){var r=e.split("."),o=r.pop(),i=this.resolve(r.join("."),n||this.collection.context),s={};s[t+"Object"]=i,s[t+"Property"]=o,this.set(s)},sourceValueChange:function(){if(this.targetObject&&this.targetProperty)try{this.targetObject.set(this.targetProperty,this.targetValue)}catch(t){console.warn(t)}}}),_mappings=new(Collection.extend({model:MappingState,lookup:function(t,e){return e=e?"targetObject":"sourceObject",_mappings.filter(function(n){return n[e+"Path"]===t})},resolve:function(t,e){return resolve(t,e||this.context)},objectPath:function(t){return objectPath(t)},isTarget:function(t,e){var n=objectPath(t);return n=(n?n+".":"")+e,this.models.find(function(t){return t.targetPath===n})},isSource:function(t,e){var n=objectPath(t)+e;return this.models.find(function(t){return t.sourcePath===n})},sourceSuggestions:function(t){function e(e){var n=["mappable","parent","collection",t.idAttribute,t.typeAttribute];return n.indexOf(e)<0&&r.indexOf(e)>-1}var n=[];if(!t||"object"!=typeof t)return n;var r=[];t.mappable&&t.mappable.source&&(r=t.mappable.source||[]);var o=t.constructor&&t.constructor.prototype?t.constructor.prototype:{},i=Object.keys(o._definition||{}),s=Object.keys(o._derived||{}),a=Object.keys(o._children||{}),u=Object.keys(o._collections||{});return i.concat(s,a).filter(e).forEach(function(e){var r=this.sourceSuggestions(t[e]);return r.length?void(n=n.concat(r.map(function(t){return e+"."+t}))):void(a.indexOf(e)<0&&n.push(e))},this),u.filter(e).forEach(function(e){t[e].forEach(function(t){var r=t.getId(),o=this.sourceSuggestions(t);n=n.concat(o.filter(function(t){return!!t}).map(function(t){return e+"."+r+"."+t}))},this)},this),n},targetSuggestions:function(t){function e(e){var n=["mappable","parent","collection",t.idAttribute,t.typeAttribute];return n.indexOf(e)<0&&r.indexOf(e)>-1}var n=[];if(!t||"object"!=typeof t)return n;var r=[];t.mappable&&t.mappable.target&&(r=t.mappable.target||[]);var o=t.constructor&&t.constructor.prototype?t.constructor.prototype:{},i=Object.keys(o._definition||{}),s=Object.keys(o._children||{}),a=Object.keys(o._collections||{});return i.concat(s).filter(e).forEach(function(e){var r=this.targetSuggestions(t[e]);return r.length?void(n=n.concat(r.map(function(t){return e+"."+t}))):void(s.indexOf(e)<0&&n.push(e))},this),a.filter(e).forEach(function(e){t[e].forEach(function(t){var r=t.getId(),o=this.targetSuggestions(t);n=n.concat(o.filter(function(t){return!!t}).map(function(t){return e+"."+r+"."+t}))},this)},this),n},import:function(t,e,n){if(e=e||this.context,!e)throw new Error("mappings.import() requires a context");n&&this.reset([]),this.add(t.map(function(t){var n=t.source.split("."),r=t.target.split(".");return{sourceObject:this.resolve(n.slice(0,-1).join("."),e)||e,sourceProperty:n.pop(),targetObject:this.resolve(r.slice(0,-1).join("."),e)||e,targetProperty:r.pop(),transformation:t.transform}},this))},export:function(){return this.map(function(t){return{source:t.sourcePath,target:t.targetPath,transform:(t.transformation||"").toString()}})},resetObjects:function(){this.forEach(function(t){delete t._cache.sourceObject})},remove:function(t){return t=Array.isArray(t)?t:[t],t.forEach(function(t){var e="string"==typeof t?this.get(t):t;return e?void e.stopListening():void console.info("could not determine the model for",t)},this),Collection.prototype.remove.apply(this,arguments)}}));module.exports=_mappings}("undefined"!=typeof window?window:self)},,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t){return 100/127*(t||0)}var o={prefix:"<something>",type:{128:"noteOn",144:"noteOff",176:"change",192:"search",248:"idle"},note:{1:"k1",2:"k2",3:"k3",4:"k4",5:"k5",6:"k6",7:"k7",8:"k8",36:"p1",38:"p2",40:"p3",41:"p4",43:"p5",45:"p6",47:"p7",48:"p8"},velocity:{0:function(t,e,n){return!(e>23)&&n},127:function(t,e,n){return e>23||r(n)}}};t.exports=function(t){var e=t[0]||0;if(248===e)return{};var n=t[1]||0,r=t[2]||0,i=o.note[n];return console.info("MIDI evt on %s (%s) => %s",i,n,r,t),{name:i,velocity:r,type:e}},t.exports.note=o.note,t.exports.prefix=o.prefix},function(t,e,n){"use strict";function r(t){return 100/127*(t||0)}function o(t,e){if(192===e[0])return"bpmKnob";var n=a.note[""+t];return"function"==typeof n?n(e[0],e[1],e[2]):n}var i=[49,50,51,52,53,54,55,56,92,95],s=[36,37,38,39],a={prefix:"kp3",type:{128:"noteOn",144:"noteOff",176:"change",192:"search",248:"idle"},note:{36:"buttonA",37:"buttonB",38:"buttonC",39:"buttonD",49:"num1",50:"num2",51:"num3",52:"num4",53:"num5",54:"num6",55:"num7",56:"num8",70:"padX",71:"padY",72:"pad72",73:"pad73",74:"pad74",75:"pad75",76:"pad76",92:"pad",93:"effectSlider",94:"effectKnob",95:"hold"},velocity:{0:function(t,e,n){return!(i.indexOf(e)>-1)&&n},64:function(t,e,n){return!(s.indexOf(e)>-1)&&r(n)},100:function(t,e,n){return s.indexOf(e)>-1||r(n)},127:function(t,e,n){return i.indexOf(e)>-1||r(n)}},signalNames:["buttonA:noteOn","buttonA:noteOff","buttonB:noteOn","buttonB:noteOff","buttonC:noteOn","buttonC:noteOff","buttonD:noteOn","buttonD:noteOff","num1:noteOn","num1:noteOff","num2:noteOn","num2:noteOff","num3:noteOn","num3:noteOff","num4:noteOn","num4:noteOff","num5:noteOn","num5:noteOff","num6:noteOn","num6:noteOff","num7:noteOn","num7:noteOff","num8:noteOn","num8:noteOff","pad:noteOn","pad:noteOff","padX:change","padY:change","pad72:change","pad73:change","pad74:change","pad75:change","pad76:change","effectKnob:change","effectSlider:change"]};t.exports=function(t){var e=t[0]||0;if(248===e)return{};var n=t[1]||0,r=t[2]||0,i=o(n,t);return{name:i,velocity:r,type:e}},t.exports.note=a.note,t.exports.prefix=a.prefix},function(t,e,n){"use strict";function r(t){return 100/127*(t||0)}var o={prefix:"nk2",type:{128:"noteOn",144:"noteOff",176:"change",192:"search",248:"idle"},note:{0:"slider1",1:"slider2",2:"slider3",3:"slider4",4:"slider5",5:"slider6",6:"slider7",7:"slider8",16:"knob1",17:"knob2",18:"knob3",19:"knob4",20:"knob5",21:"knob6",22:"knob7",23:"knob8",32:"s1",33:"s2",34:"s3",35:"s4",36:"s5",37:"s6",38:"s7",39:"s8",41:"play",42:"stop",43:"rewind",44:"forward",45:"record",46:"cycle",48:"m1",49:"m2",50:"m3",51:"m4",52:"m5",53:"m6",54:"m7",55:"m8",58:"trackprevious",59:"tracknext",60:"markerset",61:"markerprevious",62:"markernext",64:"r1",65:"r2",66:"r3",67:"r4",68:"r5",69:"r6",70:"r7",71:"r8"},velocity:{0:function(t,e,n){return!(e>23)&&n},127:function(t,e,n){return e>23||r(n)}}};t.exports=function(t){var e=t[0]||0;if(248===e)return{};var n=t[1]||0,r=t[2]||0,i=o.note[n];return console.info("nk2 MIDI evt on %s (%s) => %s",i,n,r,e),{name:i,velocity:r,type:e}},t.exports.note=o.note,t.exports.prefix=o.prefix},function(t,e,n){"use strict";function r(t){return 100/127*(t||0)}var o={prefix:"<something>",type:{128:"noteOn",144:"noteOff",176:"change",192:"search",248:"idle"},note:{0:"pA1",1:"pA2",2:"pA3",3:"pA4",4:"pA5",5:"pA6",6:"pA7",7:"pA8",16:"pB1",17:"pB2",18:"pB3",19:"pB4",20:"pB5",21:"pB6",22:"pB7",23:"pB8",32:"pC1",33:"pC2",34:"pC3",35:"pC4",36:"pC5",37:"pC6",38:"pC7",39:"pC8",48:"pD1",49:"pD2",50:"pD3",51:"pD4",52:"pD5",53:"pD6",54:"pD7",55:"pD8",64:"pE1",65:"pE2",66:"pE3",67:"pE4",68:"pE5",69:"pE6",70:"pE7",71:"pE8",80:"pF1",81:"pF2",82:"pF3",83:"pF4",84:"pF5",85:"pF6",86:"pF7",87:"pF8",96:"pI1",97:"pI2",98:"pI3",99:"pI4",100:"pI5",101:"pI6",102:"pI7",103:"pI8",112:"pJ1",113:"pJ2",114:"pJ3",115:"pJ4",116:"pJ5",117:"pJ6",118:"pJ7",119:"pJ8"},velocity:{0:function(t,e,n){return!(e>23)&&n},127:function(t,e,n){return e>23||r(n)}},signalNames:[]};t.exports=function(t){var e=t[0]||0;if(248===e)return{};var n=t[1]||0,r=t[2]||0,i=o.note[n];return console.info("MIDI evt on %s (%s) => %s",i,n,r,e),{name:i,velocity:r,type:e}},t.exports.note=o.note,t.exports.prefix=o.prefix},function(t,e,n){"use strict";var r=window.VFDeps.assign,o=n(15),i=n(46),s=n(14),a=o.extend({template:'<section><header><h3>Details for <span data-hook="name"></span></h3></header><div class="row mappings props"></div><div class="row gutter transformations-control columns"><input class="column gutter-right" placeholder="New transformation" data-hook="new-transformation-name" type="text"/><div class="column gutter-left no-grow"><button name="add-transformation" class="vfi-plus"></button></div></div><div class="row transformations props"></div></section>',
subviews:r({},o.prototype.subviews,{transformationsView:{selector:".transformations",prepareView:function(t){return this.renderCollection(this.model.transformations,i,t)}}}),events:{"click [name=add-transformation]":"_addTransformation","focus [data-hook=new-transformation-name]":"_focusName"},_focusName:function(){var t=this.queryByHook("new-transformation-name"),e=this.rootView.suggestionHelper;t.select(),e.attach(t,function(n){t.value=n,e.detach()}).fill(Object.keys(s))},_addTransformation:function(){this.model.transformations.add({name:this.queryByHook("new-transformation-name").value.trim()})},bindings:r({"model.name":"[data-hook=name]"},o.prototype.bindings)});t.exports=a},function(t,e,n){"use strict";var r=window.VFDeps.View,o=r.extend({template:'<div class="transformation gutter columns"><div class="column gutter-right text-right" data-hook="name"></div><div class="column gutter-horizontal no-grow"><button name="remove" class="vfi-trash-empty"></button></div><input class="column gutter-left" data-hook="arguments" type="text"/></div>',derived:{arguments:{deps:["model","model.arguments"],fn:function(){return(this.model.arguments||[]).join(",")}}},parseArguments:function(t){var e=this.model;t=(t||this.queryByHook("arguments").value).trim();var n=0===e.name.indexOf("math."),r=t.split(",").map(function(t){return t=n?Number(t):t,t=n&&isNaN(t)?0:t});this.model.arguments=r},bindings:{"model.name":"[data-hook=name]","model.arguments":{hook:"arguments",type:function(t){t!==document.activeElement&&(t.value=this.model.arguments.join(","))}}},events:{"click [name=remove]":"_remove","keyup [data-hook=arguments]":"_changeArguments"},_remove:function(){this.model.collection.remove(this.model)},_changeArguments:function(){this.parseArguments()}});t.exports=o}]);
//# sourceMappingURL=0-build.js.map