webpackJsonp([3],{10:function(t,e,n){"use strict";var o=window.VFDeps.assign,r=n(6),i=r.types.beatSignal=r.extend({template:'<section class="rows signal signal-beat"><header class="row"><h3 class="name"></h3></header><div class="row columns gutter-horizontal gutter-bottom"><div class="column result-dot no-grow gutter-right"></div><div class="column result gutter-left"><input class="column input" placeholder="BPM" data-hook="input" /></div></div><div class="row mappings props"></div></section>',bindings:o({},r.prototype.bindings,{"model.result":[{selector:".result-dot",type:function(t,e){t.style.backgroundColor="hsla(190, 81%, 67%,"+e/100+")"}}]}),events:o({},r.prototype.events,{"change [data-hook=input]":"_updateBPM"}),_updateBPM:function(){this.model.input=parseInt(this.queryByHook("input").value.trim(),10)},render:function(){this.renderWithTemplate();var t=this.queryByHook("input");return t&&!t.value&&(t.value=this.model.input),this}});t.exports=i},11:function(t,e,n){"use strict";var o=n(6),r=n(7),i=o.types.rgbaSignal=r.extend({});t.exports=i},21:function(t,e,n){"use strict";var o=n(23),r=VFDeps.assign,i=VFDeps.Collection,s=VFDeps.State,a=VFDeps.View,u=a.extend({template:'<div class="columns object-prop prop-type-default"><div class="column gutter text-right prop-name"></div><div class="column no-grow prop-value-reset"><button class="vfi-cancel"></button></div><div class="column prop-value"><input name="value" type="text" /></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',initialize:function(){var t=this._handleChange.bind(this);this.on("change:el",function(){this.previousAttributes.el&&this.previousAttributes.el.removeEventListener("change",t,{passive:!0}),this.el&&this.el.addEventListener("change",t,{passive:!0})}),this.listenTo(this.parent.model,"all",function(t){t==="change:"+this.model.name&&this.trigger("change:parent.model")})},derived:{suggestionHelper:{cache:!1,fn:function(){for(var t=this.parent;t;){if(t.suggestionHelper)return t.suggestionHelper;t=t.parent}return!1}},value:{deps:["model","model.name","parent.model"],fn:function(){return this.parent.model.get(this.model.name)}},mappingPath:{deps:["value"],fn:function(){return o.objectPath(this.parent.model)+this.model.name}},mappingObject:{deps:["value"],fn:function(){return o.isTarget(this.parent.model,this.model.name)}}},bindings:{"model.name":{type:"text",selector:".prop-name"},value:{type:function(t,e){t!==document.activeElement&&(t.value=e)},selector:"input[name=value]"},mappingObject:{type:"booleanAttribute",selector:".prop-mapping-clear button",name:"disabled",invert:!0}},events:{"click .prop-value-reset button":"_handleReset","change [name=mapping]":"_handleMappingChange","focus [type=text][name=value]":"_suggestValues","focus [name=mapping]":"_suggestMappings"},_handleReset:function(){this.parent.model.unset(this.model.name)},_handleMappingChange:function(){console.info("_handleMappingChange")},_suggestValues:function(t){var e=this.suggestionHelper;if(e&&this.model.values&&this.model.values.length){var n=t.target;e.attach(n,function(t){n.value=t,e.detach()}).fill(this.model.values)}},_suggestMappings:function(t){console.info("_suggestMappings",this.model.values,t.target,t.delegatedTarget)},_handleChange:function(t){this.parent.model.set(this.model.name,t.target.value)}});u.types={},u.types.boolean=u.extend({template:'<div class="columns object-prop prop-type-boolean"><div class="column gutter text-right prop-name"></div><div class="column no-grow"><button class="vfi-cancel"></button></div><div class="column prop-value"><button class="prop-toggle-btn"></button></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',bindings:r({},u.prototype.bindings,{value:{selector:"button.prop-toggle-btn",type:"booleanClass",yes:"vfi-toggle-on",no:"vfi-toggle-off"}}),events:{"click button.prop-toggle-btn":"_handleToggle"},_handleChange:function(){},_handleToggle:function(){this.parent.model.toggle(this.model.name)}}),u.types.number=u.extend({template:'<div class="columns object-prop prop-type-number"><div class="column gutter text-right prop-name"></div><div class="column no-grow"><button class="vfi-cancel"></button></div><div class="column prop-value"><input name="value" type="number" /></div><div class="column prop-mapping-clear"><button class="vfi-unlink"></button></div></div>',bindings:r({},u.prototype.bindings,{min:[{selector:"[name=value]",type:function(t,e){null!==e&&"undefined"!=typeof e?t.setAttribute("min",e):t.removeAttribute("min")}}],max:[{selector:"[name=value]",type:function(t,e){null!==e&&"undefined"!=typeof e?t.setAttribute("max",e):t.removeAttribute("max")}}]}),session:{min:["number",!1,null],max:["number",!1,null]},_handleChange:function(t){this.parent.model.set(this.model.name,Number(t.target.value))}}),u.names={},u.names.active=u.types.boolean.extend({}),u.names.opacity=u.types.number.extend({session:{min:["number",!1,0],max:["number",!1,100]}}),u.names.skewX=u.names.skewY=u.names.rotateX=u.names.rotateY=u.names.rotateZ=u.types.number.extend({session:{min:["number",!1,-360],max:["number",!1,360]}});var l=a.extend({template:'<section class="row rows"><header class="row no-grow"><h3>Details for <span data-hook="name"></span></h3><h5 data-hook="object-path"></h5></header><div class="row items"></div></section>',initialize:function(){this.listenToAndRun(this,"change:definition",function(){this.properties.reset(this.definition)})},derived:{propNames:{deps:["model"],fn:function(){var t=this.model.constructor.prototype._definition;return Object.keys(t).filter(function(t){return["drawFunction","uiState","name","type","zIndex"].indexOf(t)<0})}},definition:{deps:["propNames"],fn:function(){var t=this.model.constructor.prototype._definition;return this.propNames.map(function(e){return r({name:e},t[e])})}},objectPath:{deps:["model"],fn:function(){return o.objectPath(this.model)}}},collections:{properties:i.extend({mainIndex:"name",model:s.extend({idAttribute:"name",session:{name:"string",allowNull:"boolean",default:"any",required:"boolean",test:"any",type:"string",values:"array"}})})},subviews:{propertiesView:{waitFor:"el",selector:".items",prepareView:function(t){return this.renderCollection(this.properties,function(t){var e=u.names[t.model.name]||u.types[t.model.type]||u;return new e(t)},t)}}},bindings:{"model.uiState":{selector:"header",type:"class"},"model.name":"[data-hook=name]",objectPath:'[data-hook="object-path"]'}});t.exports=l},23:function(module,exports){!function(global){"use strict";function isCollectionOfParent(t,e){if(e&&e._collections)for(var n in e._collections)if(e[n]===t.collection)return n+"."+t.getId()}function isChildOfParent(t,e){if(e&&e._children)for(var n in e._children)if(e[n]===t)return n}function isPropOfParent(t,e){if(e)for(var n in e)if(e[n]===t)return n}function objectPath(t){if(!t)return null;var e=[],n=function(t){var o=t.collection?isCollectionOfParent(t,t.collection.parent):null;if(o)return e.unshift(o),n(t.collection.parent);var r=isChildOfParent(t,t.parent);if(r)return e.unshift(r),n(t.parent);var i=isPropOfParent(t,t.parent);return i?(e.unshift(i),n(t.parent)):void(t.parent&&n(t.parent))};return n(t),e.join(".")}function resolve(t,e){function n(t){var e=t.split("."),n=function(t){if(!e.length)return t;var o=e.shift();return t[o]&&t[o].isCollection?n(t[o].get(e.shift())):"undefined"!=typeof t[o]?n(t[o]):void 0};return n}if(!e)throw new Error("Missing context to solve mapping path");return n(t)(e)}var State=global.VFDeps.State,Collection=global.VFDeps.Collection,MappingState=State.extend({mappable:{source:[],target:[]},props:{sourceObject:["state",!0,null],sourceProperty:["string",!0,null],targetObject:["state",!1,null],targetProperty:["string",!1,null],transformation:["any",!1,null]},session:{uiState:{type:"string",values:["","dependency","dependent","focus","highlighted"],default:"",required:!0}},derived:{sourcePath:{deps:["sourceObject","sourceProperty"],fn:function(){var t=objectPath(this.sourceObject);return(t?t+".":"")+this.sourceProperty}},sourceValue:{deps:["sourceObject","sourceProperty"],fn:function(){return this.sourceObject.get(this.sourceProperty)}},sourceObjectType:{deps:["sourceValue"],fn:function(){return typeof this.sourceValue}},transformationFunction:{deps:["transformation"],fn:function(){var noop=function(t){return t},fn;if("function"==typeof this.transformation)fn=this.transformation.bind(this);else if("string"==typeof this.transformation)try{eval("fn = "+this.transformation+";")}catch(t){console.warn(t),fn=noop}else fn=noop;return fn}},targetPath:{deps:["targetObject","targetProperty"],fn:function(){if(!this.targetObject||!this.targetProperty)return null;var t=objectPath(this.targetObject);return(t?t+".":"")+this.targetProperty}},targetValue:{deps:["sourceValue","targetObject","targetProperty","transformationFunction"],fn:function(){return this.targetObject&&this.targetProperty?this.transformationFunction.call(this,this.sourceValue):null}}},objectPath:function(t){return objectPath(t)},resolve:function(t,e){return resolve(t,e||this.collection.context)},initialize:function(t){if(!t.sourceObject||!t.sourceProperty)throw new Error("Missing sourceObject information");this.listenToAndRun(this,"change:targetValue",this.sourceValueChange),this.listenToAndRun(this.sourceObject,"all",function(t){t==="change:"+this.sourceProperty&&this.trigger("change:sourceProperty")})},updateInfo:function(t,e,n){var o=e.split("."),r=o.pop(),i=this.resolve(o.join("."),n||this.collection.context),s={};s[t+"Object"]=i,s[t+"Property"]=r,this.set(s)},sourceValueChange:function(){this.targetObject&&this.targetProperty&&this.targetObject.set(this.targetProperty,this.targetValue)}}),_mappings=new(Collection.extend({model:MappingState,lookup:function(t,e){return e=e?"targetObject":"sourceObject",_mappings.filter(function(n){return n[e+"Path"]===t})},resolve:function(t,e){return resolve(t,e||this.context)},objectPath:function(t){return objectPath(t)},isTarget:function(t,e){var n=objectPath(t);return n=(n?n+".":"")+e,this.models.find(function(t){return t.targetPath===n})},isSource:function(t,e){var n=objectPath(t)+e;return this.models.find(function(t){return t.sourcePath===n})},sourceSuggestions:function(t){function e(e){var n=["mappable","parent","collection",t.idAttribute,t.typeAttribute];return n.indexOf(e)<0&&o.indexOf(e)>-1}var n=[];if(!t||"object"!=typeof t)return n;var o=[];t.mappable&&t.mappable.source&&(o=t.mappable.source||[]);var r=t.constructor&&t.constructor.prototype?t.constructor.prototype:{},i=Object.keys(r._definition||{}),s=Object.keys(r._derived||{}),a=Object.keys(r._children||{}),u=Object.keys(r._collections||{});return i.concat(s,a).filter(e).forEach(function(e){var o=this.sourceSuggestions(t[e]);return o.length?void(n=n.concat(o.map(function(t){return e+"."+t}))):void(a.indexOf(e)<0&&n.push(e))},this),u.filter(e).forEach(function(e){t[e].forEach(function(t){var o=t.getId(),r=this.sourceSuggestions(t);n=n.concat(r.filter(function(t){return!!t}).map(function(t){return e+"."+o+"."+t}))},this)},this),n},targetSuggestions:function(t){function e(e){var n=["mappable","parent","collection",t.idAttribute,t.typeAttribute];return n.indexOf(e)<0&&o.indexOf(e)>-1}var n=[];if(!t||"object"!=typeof t)return n;var o=[];t.mappable&&t.mappable.target&&(o=t.mappable.target||[]);var r=t.constructor&&t.constructor.prototype?t.constructor.prototype:{},i=Object.keys(r._definition||{}),s=Object.keys(r._children||{}),a=Object.keys(r._collections||{});return i.concat(s).filter(e).forEach(function(e){var o=this.targetSuggestions(t[e]);return o.length?void(n=n.concat(o.map(function(t){return e+"."+t}))):void(s.indexOf(e)<0&&n.push(e))},this),a.filter(e).forEach(function(e){t[e].forEach(function(t){var o=t.getId(),r=this.targetSuggestions(t);n=n.concat(r.filter(function(t){return!!t}).map(function(t){return e+"."+o+"."+t}))},this)},this),n},import:function(t,e){if(e=e||this.context,!e)throw new Error("mappings.import() requires a context");this.add(t.map(function(t){var n=t.source.split("."),o=t.target.split(".");return{sourceObject:this.resolve(n.slice(0,-1).join("."),e)||e,sourceProperty:n.pop(),targetObject:this.resolve(o.slice(0,-1).join("."),e)||e,targetProperty:o.pop(),transformation:t.transform}},this))},export:function(){return this.map(function(t){return{source:t.sourcePath,target:t.targetPath,transform:(t.transformation||"").toString()}})},remove:function(t){return t=Array.isArray(t)?t:[t],t.forEach(function(t){var e="string"==typeof t?this.get(t):t;return e?void e.stopListening():void console.info("could not determine the model for",t)},this),Collection.prototype.remove.apply(this,arguments)}}));module.exports=_mappings}("undefined"!=typeof window?window:self)},45:function(t,e,n){"use strict";var o=window.VFDeps.assign,r=n(21),i=n(48),s=n(24),a=r.extend({template:'<section><header><h3>Details for <span data-hook="name"></span></h3></header><div class="row mappings props"></div><div class="row gutter transformations-control columns"><input class="column gutter-right" placeholder="New transformation" data-hook="new-transformation-name" type="text"/><div class="column gutter-left no-grow"><button name="add-transformation" class="vfi-plus"></button></div></div><div class="row transformations props"></div></section>',subviews:o({},r.prototype.subviews,{transformationsView:{selector:".transformations",prepareView:function(t){return this.renderCollection(this.model.transformations,i,t)}}}),events:{"click [name=add-transformation]":"_addTransformation","focus [data-hook=new-transformation-name]":"_focusName"},_focusName:function(){var t=this.queryByHook("new-transformation-name"),e=this.rootView.suggestionHelper;t.select(),e.attach(t,function(n){t.value=n,e.detach()}).fill(Object.keys(s))},_addTransformation:function(){this.model.transformations.add({name:this.queryByHook("new-transformation-name").value.trim()})},bindings:o({"model.name":"[data-hook=name]"},r.prototype.bindings)});t.exports=a},48:function(t,e,n){"use strict";var o=window.VFDeps.View,r=o.extend({template:'<div class="transformation gutter columns"><div class="column gutter-right text-right" data-hook="name"></div><div class="column gutter-horizontal no-grow"><button name="remove" class="vfi-trash-empty"></button></div><input class="column gutter-left" data-hook="arguments" type="text"/></div>',derived:{arguments:{deps:["model","model.arguments"],fn:function(){return(this.model.arguments||[]).join(",")}}},parseArguments:function(t){var e=this.model;t=(t||this.queryByHook("arguments").value).trim();var n=0===e.name.indexOf("math."),o=t.split(",").map(function(t){return t=n?Number(t):t,t=n&&isNaN(t)?0:t});this.model.arguments=o},bindings:{"model.name":"[data-hook=name]","model.arguments":{hook:"arguments",type:function(t){t!==document.activeElement&&(t.value=this.model.arguments.join(","))}}},events:{"click [name=remove]":"_remove","keyup [data-hook=arguments]":"_changeArguments"},_remove:function(){this.model.collection.remove(this.model)},_changeArguments:function(){this.parseArguments()}});t.exports=r},6:function(t,e,n){"use strict";var o=window.VFDeps.View,r=n(45),i=o.extend({template:'<section class="rows signal"><header class="row"><h3 class="row name"></h3></header><div class="row gutter-horizontal columns test text-center"><input class="column input" placeholder="Input" type="text"/><div class="column gutter-horizontal no-grow">&raquo;</div><div class="column result"></div></div></section>',session:{input:"any",showMappings:["boolean",!0,!1]},derived:{result:{deps:["input","model","model.transformations"],fn:function(){return this.model.computeSignal(this.input)}}},bindings:{"model.name":".name",result:".test .result"},events:{"change .test .input":"_testValue","click header h3":"_showDetails"},_showDetails:function(){this.rootView.showDetails(new r({parent:this,model:this.model}))},_testValue:function(t){this.input=t.target.value.trim()},render:function(){this.renderWithTemplate();var t=this.query(".test .input");return t&&!t.value&&(t.value=this.input||null),this}});i.types={},t.exports=i},7:function(t,e,n){"use strict";var o=window.VFDeps.assign,r=n(6),i=r.types.hslaSignal=r.extend({template:['<section class="rows signal signal-color">','<header class="row">','<h3 class="name"></h3>',"</header>",'<div class="row columns gutter-horizontal gutter-bottom">','<div class="column result-color no-grow"></div>','<div class="column result gutter-left"></div>',"</div>",'<div class="row mappings props"></div>',"</section>"].join(""),bindings:o({},r.prototype.bindings,{"model.result":[{selector:".result-color",type:function(t,e){t.style.backgroundColor=e}},{selector:".result",type:"text"}]})});t.exports=i}});
//# sourceMappingURL=3-build.js.map