{"version":3,"sources":["webpack:///./layer/state.js?5df1","webpack:///./layer/canvas/state.js?c004","webpack:///./layer/img/state.js?78c3","webpack:///./layer/p5/state.js?8f41","webpack:///./layer/svg/state.js?a8f9","webpack:///./layer/threejs/state.js?1636","webpack:///./layer/txt/state.js?404e","webpack:///./layer/video/state.js?dc77","webpack:///./utils/object-path.js?b81b","webpack:///./parameter/collection.js?1b7e","webpack:///./layer/canvas/mocked-canvas-2d-context.js?fd04","webpack:///./utils/midi-min-max.js?ebf9","webpack:///./utils/midi2prct.js?b3ef","webpack:///./utils/midi2rad.js?4c38","webpack:///./layer/canvas/canvas-utils.js?e8ca","webpack:///./layer/canvas/compile-draw-function.js?3979","webpack:///./layer/svg/extractor.js?effa","webpack:///./parameter/state.js?7db5","webpack:///./utils/prct.js?a887"],"names":[],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,mEAAmE,iBAAiB;AACpF,KAAK;AACL,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA,KAAK,2CAA2C;AAChD,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,sDAAsD;AACtD,2CAA2C;AAC3C,8CAA8C;AAC9C;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;;AAEA,4B;;;;;;;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;AACA,4CAA4C,qBAAqB,EAAE;AACnE,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,YAAY;AACvC;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC,E;;;;;;;;AC1ID;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC,E;;;;;;;;ACnBD;AACA;;AAEA;AACA;AACA,8EAA8E;AAC9E,4EAA4E;AAC5E;AACA,CAAC;AACD,8B;;;;;;;;ACTA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA,4CAA4C,WAAW,EAAE;AACzD,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB,YAAY,GAAG,aAAa;AAClD;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA,kEAAkE,gBAAgB;AAClF,OAAO;AACP;;AAEA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;ACtGD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA,IAAI;AACJ;;AAEA,IAAI;AACJ;;AAEA,IAAI;AACJ;;AAEA,CAAC;AACD;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA,mCAAmC;AACnC;AACA;AACA,MAAM;AACN;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAED;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;AAID;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,4BAA4B,EAAE;AAC1E;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;AAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;AAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;AAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAED;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;;;;AAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,sEAAsE,EAAE;AAC1H,kDAAkD,sEAAsE,EAAE;AAC1H,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA,UAAU;AACV,QAAQ;;AAER;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;ACxiBD;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,+B;;;;;;;;AChBA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;ACfD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,4B;;;;;;;;AC7DA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,iC;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH,2B;;;;;;;;AC3EA;AACA;AACA;AACA,E;;;;;;;;ACHA;AACA;AACA;AACA,E;;;;;;;;ACHA;AACA;AACA;AACA,E;;;;;;;;ACHA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,eAAe;AAC5B,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,iBAAiB,WAAW;AAC5B;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,+BAA+B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACnOA;AACA;AACA,qCAAsC;;AAEtC;AACA;AACA;AACA;AACA,8DAA8D,MAAM,2BAA2B,EAAE,WAAW,GAAG;AAC/G,GAAG;AACH;AACA;AACA,iFAAiF,yBAAyB,wBAAwB,EAAE,yBAAyB,GAAG;AAChK,GAAG;;AAEH;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC,oCAAoC;AACpC;AACA;AACA;AACA;AACA,qCAAqC,2BAA2B,uBAAuB;AACvF;AACA,gCAAgC;AAChC;AACA;AACA,gCAAgC;AAChC;;AAEA;AACA;AACA;;AAEA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,oCAAoC;AACxE,0CAA0C,2BAA2B;AACrE,sCAAsC,uBAAuB;AAC7D,mCAAmC,yBAAyB;AAC5D,mCAAmC,yBAAyB;AAC5D,mCAAmC,yBAAyB;AAC5D,sCAAsC,4BAA4B;AAClE,wCAAwC,8BAA8B;AACtE,oCAAoC,0BAA0B;AAC9D,4CAA4C,kCAAkC;AAC9E,+CAA+C,qCAAqC;;;AAGpF,cAAc,0BAA0B;AACxC;AACA,CAAC,IAAI;AACL,eAAe;AACf;AACA;;AAEA,iC;;;;;;;;ACpEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,mBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,kDAAkD,mCAAmC,EAAE;AACvF,oDAAoD,8BAA8B;;AAElF,4CAA4C,aAAa;;AAEzD;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,2B;;;;;;;;ACtFA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,4B;;;;;;;;AC5BA;AACA;AACA;AACA;AACA,E","file":"6-build.js","sourcesContent":["'use strict';\nvar State = require('ampersand-state');\n\nvar objectPath = require('./../utils/object-path');\nvar ParameterCollection = require('./../parameter/collection');\n\nvar LayerState = State.extend({\n  idAttribute: 'name',\n  typeAttribute: 'type',\n\n  initialize: function() {\n    var state = this;\n\n    state.ensureParameters();\n\n    state.listenToAndRun(state.parameters, 'change', function() {\n      state.trigger('change:parameters', state, state.parameters, {parameters: true});\n    });\n  },\n\n  collections: {\n    parameters: ParameterCollection\n  },\n\n  baseParameters: [\n    {name: 'zIndex', type: 'number', default: 0},\n    {name: 'active', type: 'boolean', default: true}\n  ],\n\n  ensureParameters: function(definition = []) {\n    (this.baseParameters || [])\n      .concat(definition)\n      .forEach(function(parameterDef) {\n        var existing = this.parameters.get(parameterDef.name);\n        if (!existing) {\n          var created = this.parameters.add(parameterDef);\n          this.listenTo(created, 'change:value', function(...args) {\n            this.trigger('change:parameters.' + created.name, ...args);\n          });\n          created.value = parameterDef.default;\n        }\n      }, this);\n    return this;\n  },\n\n  props: {\n    name: ['string', true, null],\n    type: ['string', true, 'default'],\n    layerStyles: ['string', false, '']\n  },\n\n  derived: {\n    modelPath: {\n      deps: ['name'],\n      fn: function() {\n        return objectPath(this);\n      }\n    },\n    active: {\n      deps: ['parameters.active'],\n      fn: function() {\n        return this.parameters.getValue('active');\n      }\n    },\n    zIndex: {\n      deps: ['parameters.zIndex'],\n      fn: function() {\n        return this.parameters.getValue('zIndex');\n      }\n    },\n    screenState: {\n      deps: ['collection', 'collection.parent'],\n      fn: function() {\n        return this.collection.parent;\n      }\n    },\n    hasDOM: {\n      deps: ['screenState'],\n      fn: function() {\n        return this.screenState && this.screenState.hasDOM;\n      }\n    },\n    isControllerState: {\n      deps: ['screenState'],\n      fn: function() {\n        return this.screenState && this.screenState.isControllerState;\n      }\n    },\n    location: {\n      deps: ['isControllerState', 'hasDOM'],\n      fn: function() {\n        return this.screenState ? this.screenState.location : false;\n      }\n    },\n\n    mappable: {\n      deps: [],\n      fn: function() {\n        var proto = this.constructor.prototype;\n        var keys = Object.keys(proto._definition || {}).concat(\n          Object.keys(proto._children || {}),\n          Object.keys(proto._collections || {})\n        ).filter(function(key) {\n          return key !== this.idAttribute && key !== this.typeAttribute;\n        }, this);\n\n        return {\n          source: [],\n          target: keys\n        };\n      }\n    }\n  },\n\n  _log: function(...args) {\n    this.screenState._log(...args);\n  }\n});\n\nLayerState.types = {};\n\nmodule.exports = LayerState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/state.js\n// module id = 150\n// module chunks = 4 6","'use strict';\nvar Collection = require('ampersand-collection');\nvar ParameterCollection = require('./../../parameter/collection');\nvar ScreenLayerState = require('./../state');\nvar mockedCtx = require('./mocked-canvas-2d-context');\nvar compileFunction = require('./compile-draw-function');\nfunction drawLayerCtx() {\n  /*\n    You can access the canvas 2d context with the global ctx\n  */\n}\n\nvar CanvasLayer = ScreenLayerState.extend({\n  idAttribute: 'name',\n  cache: {},\n\n  props: {\n    drawFunction: ['any', true, function() { return drawLayerCtx; }]\n  },\n\n  collections: {\n    parameters: ParameterCollection\n  },\n\n  toJSON: function(...args) {\n    return this.toJSON(...args);\n  },\n\n  derived: {\n    mappable: {\n      deps: ScreenLayerState.prototype._derived.mappable.deps,\n      fn: function() {\n        var mappable = ScreenLayerState.prototype._derived.mappable.fn.apply(this, arguments);\n        var targets = mappable.target.filter(function(key) {\n          return [\n            'drawFunction',\n            'screenState', // would make a circular reference if not excluded!\n            'draw'\n          ].indexOf(key) < 0;\n        });\n        console.info('targets for %s', this.name, targets);\n        return {\n          source: [],\n          target: targets\n        };\n      }\n    },\n\n    screenState: {\n      deps: [],\n      fn: function() {\n        return this.collection.parent.screenState;\n      }\n    },\n\n    frametime: {\n      cache: false,\n      deps: ['screenState'],\n      fn: function() {\n        if (!this.screenState) return 0;\n        return this.screenState.clock.frametime || 0;\n      }\n    },\n    audio: {\n      cache: false,\n      deps: ['screenState'],\n      fn: function() {\n        if (!this.screenState) return {};\n        return this.screenState.audio || {};\n      }\n    },\n\n    width: {\n      deps: ['screenState', 'screenState.width'],\n      fn: function() {\n        return this.screenState.width || 400;\n      }\n    },\n    height: {\n      deps: ['screenState', 'screenState.height'],\n      fn: function() {\n        return this.screenState.height || 300;\n      }\n    },\n    draw: {\n      deps: ['drawFunction'],\n      fn: function() {\n        var fn, result, err;\n\n        try {\n          fn = compileFunction(this.drawFunction);\n          result = fn.call(this, mockedCtx);\n          err = result instanceof Error ? result : null;\n        }\n        catch(e) {\n          err = e;\n        }\n\n        if (err) {\n          console.warn('draw function error', err.stack);\n          fn = function() { return err; };\n        }\n\n        return fn.bind(this);\n      }\n    }\n  }\n});\n\nvar CanvasLayers = Collection.extend({\n  mainIndex: 'name',\n  comparator: 'zIndex',\n\n  model: function (attrs, options) {\n    var inst =  new CanvasLayer(attrs, options);\n    if (options.init === false) inst.initialize();\n    return inst;\n  }\n});\n\n\nmodule.exports = ScreenLayerState.types.canvas = ScreenLayerState.extend({\n  baseParameters: ScreenLayerState.prototype.baseParameters.concat([\n    {name: 'clear', type: 'number', default: 1}\n  ]),\n\n  derived: {\n    clear: {\n      deps: ['parameters.clear'],\n      fn: function() {\n        return this.parameters.getValue('clear');\n      }\n    }\n  },\n\n  collections: {\n    canvasLayers: CanvasLayers\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/state.js\n// module id = 154\n// module chunks = 4 6","'use strict';\nvar ScreenLayerState = require('./../state');\nmodule.exports = ScreenLayerState.types.img = ScreenLayerState.extend({\n  baseParameters: [\n    {name: 'src', type: 'string', default: ''}\n  ].concat(ScreenLayerState.prototype.baseParameters),\n\n  derived: {\n    src: {\n      deps: ['parameters.src'],\n      fn: function() {\n        return this.parameters.getValue('src');\n      }\n    }\n  },\n\n  initialize: function() {\n    ScreenLayerState.prototype.initialize.apply(this, arguments);\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/img/state.js\n// module id = 155\n// module chunks = 4 6","'use strict';\nvar LayerState = require('./../state');\n\nvar P5LayerState = LayerState.types.p5 = LayerState.extend({\n  props: {\n    setupFunction: ['string', false, 'console.info(\"no p5 setupFunction set\");'],\n    drawFunction: ['string', false, 'console.info(\"no p5 drawFunction set\");']\n  }\n});\nmodule.exports = P5LayerState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/p5/state.js\n// module id = 156\n// module chunks = 4 6","'use strict';\nvar ScreenLayerState = require('./../state');\nvar Extractor = require('./extractor');\n\nmodule.exports = ScreenLayerState.types.SVG = ScreenLayerState.extend({\n  baseParameters: [\n    {name: 'src', type: 'string', default: ''}\n  ].concat(ScreenLayerState.prototype.baseParameters),\n\n  props: {\n    svgStyles: ['object', true, function() { return {}; }]\n  },\n\n  session: {\n    content: ['string', false, '']\n  },\n\n  derived: {\n    src: {\n      deps: ['parameters.src'],\n      fn: function() {\n        return this.parameters.getValue('src');\n      }\n    },\n    mappable: {\n      deps: [],\n      fn: function() {\n        return {\n          source: [],\n          target: [\n            'parameters'\n          ]\n        };\n      }\n    }\n  },\n\n  initialize: function() {\n    var svgState = this;\n    ScreenLayerState.prototype.initialize.apply(svgState, arguments);\n\n    // load the svg string content from the worker only\n    if (!svgState.hasDOM) {\n      svgState.listenToAndRun(svgState, 'change:src', function() {\n        svgState.set({content: ''}, {silent: true});\n        svgState.loadSVG();\n      });\n    }\n\n    // only create an extractor for the state used in the controller\n    if (svgState.isControllerState) {\n      svgState.listenToAndRun(svgState, 'change:content', function() {\n        if (svgState.content) svgState.extractor = new Extractor({model: svgState});\n      });\n    }\n\n    svgState.listenTo(svgState.screenState, 'app:broadcast:bootstrap', function() {\n      svgState.loadSVG();\n    });\n  },\n\n  loadSVG: function(done) {\n    var state = this;\n    done = done || function(err/*, obj*/) {\n      if (err) {\n        // console.warn(err.message);\n        return;\n      }\n      // console.info('loaded');\n    };\n\n    var src = state.src;\n    if (!src) {\n      state.content = '';\n      return done(new Error('No src to load for ' + state.getId() + ' SVG layer'), state);\n    }\n\n    fetch(src)\n      .then(function(res) {\n        return res.text();\n      })\n      .then(function(string) {\n        state.content = string;\n        done(null, state);\n      })\n      .catch(function(err) {\n        state.content = '';\n        done(err, state);\n      });\n  },\n\n  serialize: function() {\n    var obj = ScreenLayerState.prototype.serialize.apply(this, arguments);\n    obj.content = this.content;\n    return obj;\n  },\n\n  toJSON: function() {\n    var obj = ScreenLayerState.prototype.toJSON.apply(this, arguments);\n    delete obj.content;\n    return obj;\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/svg/state.js\n// module id = 157\n// module chunks = 4 6","'use strict';\nvar ScreenLayerState = require('./../state');\nvar State = require('ampersand-state');\nvar Collection = require('ampersand-collection');\nvar ParameterCollection = require('./../../parameter/collection');\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\n\nvar Euler = State.extend({\n  props: {\n    x: ['number', true, 0],\n    y: ['number', true, 0],\n    z: ['number', true, 0]\n  }\n});\nvar Vector3 = State.extend({\n  props: {\n    x: ['number', true, 0],\n    y: ['number', true, 0],\n    z: ['number', true, 0]\n  }\n});\n// var Curve = State.extend({\n\n// });\n// var CurvePath = State.extend({\n\n// });\n// var Path = CurvePath.extend({\n\n// });\nvar Shape = State.extend({\n\n});\nvar ShapeCollection = Collection.extend({\n  model: Shape\n});\n\n\nvar Color = State.extend({\n  props: {\n    r: ['number', true, 122],\n    g: ['number', true, 122],\n    b: ['number', true, 122]\n  }\n});\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\n\n\n\nvar ThreeState = State.extend({\n  idAttribute: 'name',\n  typeAttribute: 'type',\n  props: {\n    visible: ['boolean', true, true],\n    type: ['string', true, null],\n    name: ['string', true, null]\n  },\n  children: {\n    position: Vector3,\n    rotation: Euler,\n    scale: Vector3\n  }\n});\n\nfunction makeCollectionModel(StateKind) {\n  return function(attrs, opts) {\n    var Constructor = StateKind.types[attrs.type] || StateKind;\n    var state = new Constructor(attrs, opts);\n    return state;\n  };\n}\n\n\n// function collectionParse(data) {\n//   console.info('typeof data', typeof data);\n//   return data;\n// }\n\n\n// function collectionToJSON() {\n//   var data = {};\n//   this.forEach(function(model) {// jshint ignore:line\n//     data[model.getId()] = model.serialize();\n//     delete data[model.getId()][model.idAttribute];\n//   });\n//   // console.info('collectionToJSON', data);\n//   return data;\n// }\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\nvar MaterialState = State.extend({\n  idAttribute: 'name',\n  typeAttribute: 'type',\n  props: {\n    type: ['string', false, null],\n    name: ['string', false, null]\n  },\n  children: {\n    color: Color\n  }\n});\n\nMaterialState.types = {};\n\n\n\nvar MaterialCollection = Collection.extend({\n  mainIndex: 'name',\n  // parse: collectionParse,\n  // toJSON: collectionToJSON,\n  // serialize: collectionToJSON,\n  model: makeCollectionModel(MaterialState)\n});\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\n\nvar GeometryState = ThreeState.extend({\n  children: {\n    material: MaterialState\n  }\n});\n\nGeometryState.types = {};\n// BoxBufferGeometry\n// BoxGeometry\nGeometryState.types.box = GeometryState.extend({\n  signature: ['width', 'height', 'depth'],\n  threeClassName: 'BoxGeometry',\n  props: {\n    width: ['number', true, 5],\n    height: ['number', true, 5],\n    depth: ['number', true, 5],\n  }\n});\n// CircleBufferGeometry\n// CircleGeometry\nGeometryState.types.circle = GeometryState.extend({\n  signature: ['radius', 'segments', 'thetaStart', 'thetaLength'],\n  threeClassName: 'CircleGeometry',\n  props: {\n    radius: ['number', true, 10],\n    segments: ['number', true, 8],\n    thetaStart: ['number', true, 0],\n    thetaLength: ['number', true, Math.PI * 2]\n  }\n});\n// ConeBufferGeometry\n// ConeGeometry\nGeometryState.types.cone = GeometryState.extend({\n  signature: ['radius', 'height', 'radialSegments', 'heightSegments', 'openEnded', 'thetaStart', 'thetaLength'],\n  threeClassName: 'ConeGeometry',\n  props: {\n    radius: ['number', true, 10],\n    height: ['number', true, 10],\n    radialSegments: ['number', true, 8],\n    heightSegments: ['number', true, 1],\n    openEnded: ['boolean', true, false],\n    thetaStart: ['number', true, 0],\n    thetaLength: ['number', true, Math.PI * 2]\n  }\n});\n// CylinderBufferGeometry\n// CylinderGeometry\nGeometryState.types.cylinder = GeometryState.extend({\n  signature: [\n    'radiusTop',\n    'radiusBottom',\n    'height',\n    'radialSegments',\n    'heightSegments',\n    'openEnded',\n    'thetaStart',\n    'thetaLength'\n  ],\n  threeClassName: 'CylinderGeometry',\n  props: {\n    radiusTop: ['number', true, 10],\n    radiusBottom: ['number', true, 10],\n    height: ['number', true, 10],\n    radialSegments: ['number', true, 8],\n    heightSegments: ['number', true, 1],\n    openEnded: ['boolean', true, false],\n    thetaStart: ['number', true, 0],\n    thetaLength: ['number', true, Math.PI * 2]\n  }\n});\n// DodecahedronBufferGeometry\n// DodecahedronGeometry\n// EdgesGeometry\n// ExtrudeGeometry\nGeometryState.types.extrude = GeometryState.extend({\n  signature: ['shapes', 'options'],\n  threeClassName: 'ExtrudeGeometry',\n  collections: {\n    shapes: ShapeCollection\n  },\n  props: {\n    curveSegments: 'any',// int. number of points on the curves\n    steps: 'any',// int. number of points used for subdividing segements of extrude spline\n    amount: 'any',// int. Depth to extrude the shape\n    bevelEnabled: 'any',// bool. turn on bevel\n    bevelThickness: 'any',// float. how deep into the original shape bevel goes\n    bevelSize: 'any',// float. how far from shape outline is bevel\n    bevelSegments: 'any',// int. number of bevel layers\n    extrudePath: 'any',// THREE.CurvePath. 3d spline path to extrude shape along. (creates Frames if frames aren't defined)\n    frames: 'any',// THREE.TubeGeometry.FrenetFrames. containing arrays of tangents, normals, binormals\n    material: 'any',// int. material index for front and back faces\n    extrudeMaterial: 'any',// int. material index for extrusion and beveled faces\n    UVGenerator: 'any',// Object. object that provides UV generator functions\n  }\n});\n// IcosahedronBufferGeometry\n// IcosahedronGeometry\n// LatheBufferGeometry\n// LatheGeometry\n// OctahedronBufferGeometry\n// OctahedronGeometry\n// ParametricBufferGeometry\n// ParametricGeometry\nGeometryState.types.parametric = GeometryState.extend({\n  signature: ['func', 'slices', 'stacks'],\n  threeClassName: 'ParametricGeometry',\n  props: {\n    func: ['string', true, 'function(u, v) { return new THREE.Vector3(); }'],\n    slices: ['number', true, 5],\n    stacks: ['number', true, 5]\n  }\n});\n// PlaneBufferGeometry\n// PlaneGeometry\n// PolyhedronBufferGeometry\n// PolyhedronGeometry\n// RingBufferGeometry\n// RingGeometry\n// ShapeBufferGeometry\n// ShapeGeometry\n// SphereBufferGeometry\n// SphereGeometry\n// TetrahedronBufferGeometry\n// TetrahedronGeometry\n// TextGeometry\n// TorusBufferGeometry\n// TorusGeometry\n// TorusKnotBufferGeometry\n// TorusKnotGeometry\n// TubeGeometry\n// TubeBufferGeometry\n// WireframeGeometry\n\n\nvar GeometryCollection = Collection.extend({\n  mainIndex: 'name',\n  // parse: collectionParse,\n  // toJSON: collectionToJSON,\n  // serialize: collectionToJSON,\n  model: makeCollectionModel(GeometryState)\n});\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\nvar LightState = ThreeState.extend({\n  props: {\n    intensity: ['number', true, 1]\n  },\n  children: {\n    color: Color\n  }\n});\n\nLightState.types = {};\n// AmbientLight\nLightState.types.ambient = LightState.extend({\n  signature: [],\n  threeClassName: 'AmbientLight',\n});\n// DirectionalLight\nLightState.types.directonal = LightState.extend({\n  signature: [],\n  threeClassName: 'DirectionalLight',\n  children: {\n    lookAt: Vector3\n  }\n});\n// HemisphereLight\n// Vector3Light\n// RectAreaLight\n// SpotLight\n\n\n\n\nvar LightCollection = Collection.extend({\n  mainIndex: 'name',\n  // parse: collectionParse,\n  // toJSON: collectionToJSON,\n  // serialize: collectionToJSON,\n  model: makeCollectionModel(LightState)\n});\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\nvar CameraState = ThreeState.extend({\n  children: {\n    lookAt: Vector3\n  }\n});\n\nCameraState.types = {};\n// CubeCamera\n// OrthographicCamera\nCameraState.types.orthographic = CameraState.extend({\n  signature: ['left', 'right', 'top', 'bottom', 'near', 'far'],\n  threeClassName: 'OrthographicCamera',\n  props: {\n    left: ['number', true, 80],\n    right: ['number', true, 80],\n    top: ['number', true, 60],\n    bottom: ['number', true, 60],\n    near: ['number', true, 0.1],\n    far: ['number', true, 2000]\n  }\n});\n// PerspectiveCamera\nCameraState.types.perspective = CameraState.extend({\n  signature: ['fov', 'aspect', 'near', 'far'],\n  threeClassName: 'PerspectiveCamera',\n  props: {\n    focus: ['number', true, 10],\n    fov: ['number', true, 50],\n    aspect: ['number', true, 1],\n    near: ['number', true, 0.1],\n    far: ['number', true, 2000],\n    zoom: ['number', true, 1]\n  }\n});\n// StereoCamera\n\n\n\nvar CameraCollection = Collection.extend({\n  mainIndex: 'name',\n  // parse: collectionParse,\n  // toJSON: collectionToJSON,\n  // serialize: collectionToJSON,\n  model: makeCollectionModel(CameraState)\n});\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\nvar LoaderState = ThreeState.extend({\n  props: {\n    path: ['string', false, ''],\n    src: ['string', true, ''],\n  },\n  children: {\n    material: MaterialState\n  }\n});\n\nLoaderState.types = {};\nLoaderState.types.obj = LoaderState.extend({});\nLoaderState.types.objmtl = LoaderState.extend({\n  props: {\n    mtl: ['string', true, '']\n  }\n});\n\nvar LoaderCollection = Collection.extend({\n  mainIndex: 'name',\n  model: makeCollectionModel(LoaderState)\n});\n\n\n\n/***************************************\\\n *                                     *\n *                                     *\n *                                     *\n\\***************************************/\nmodule.exports = ScreenLayerState.types.threejs = ScreenLayerState.extend({\n  props: {\n    currentCamera: ['string', false, null],\n    renderFunction: ['string', true, 'function() { console.info(\\'missing renderFunction for %s\\', layer.model.getId()); }'],\n    updateFunction: ['string', true, 'function() { console.info(\\'missing updateFunction for %s\\', layer.model.getId()); }']\n  },\n\n  collections: {\n    parameters: ParameterCollection,\n    //\n    geometries: GeometryCollection,\n    lights: LightCollection,\n    cameras: CameraCollection,\n    materials: MaterialCollection,\n    //\n    loaders: LoaderCollection\n  },\n\n  // parse: function(data) {\n  //   console.info('parse three data', data);\n\n  //   [\n  //     'geometries',\n  //     'lights',\n  //     'cameras',\n  //     'materials'\n  //   ].forEach(function(collectionName) {\n  //     data[collectionName] = Object.keys(data[collectionName] || {}).map(function(name) {\n  //       var obj = data[collectionName][name];\n  //       obj.name = name;\n  //       return obj;\n  //     });\n  //   });\n\n  //   return data;\n  // },\n\n  // toJSON: function() {\n  //   var data = ScreenLayerState.prototype.toJSON.apply(this, arguments);\n  //   // console.info('toJSON', data.cameras);\n  //   return data;\n  // },\n\n  // serialize: function() {\n  //   var data = ScreenLayerState.prototype.serialize.apply(this, arguments);\n  //   // console.info('serialize', data.cameras);\n  //   return data;\n  // },\n\n  initialize: function(attrs) {\n    ScreenLayerState.prototype.initialize.apply(this, arguments);\n    var noLights = !this.lights.length && (!attrs.lights || !attrs.lights.length);\n    var noCameras = !this.cameras.length && (!attrs.cameras || !attrs.cameras.length);\n    var noGeometries = !this.geometries.length && (!attrs.geometries || !attrs.geometries.length);\n\n    if (noLights) {\n      this.lights.add([\n        {\n          type: 'ambient',\n          name: 'defaultambient',\n          color: {\n            r: 1,\n            g: 1,\n            b: 1\n          }\n        },\n        {\n          type: 'directonal',\n          name: 'defaultdirectonal',\n          color: {\n            r: 1,\n            g: 1,\n            b: 1\n          },\n          position: {\n            x: 45,\n            y: 45,\n            z: 45\n          },\n          lookAt: {\n            x: 0,\n            y: 0,\n            z: 0\n          }\n        }\n      ]);\n    }\n\n    if (noCameras) {\n      this.cameras.add([\n        {\n          type: 'perspective',\n          name: 'defaultperspective',\n          position: {\n            x: 35,\n            y: 35,\n            z: 35\n          },\n          lookAt: {\n            x: 0,\n            y: 0,\n            z: 0\n          }\n        },\n        {\n          type: 'orthographic',\n          name: 'defaultortho',\n          position: {\n            x: 35,\n            y: 35,\n            z: 35\n          },\n          lookAt: {\n            x: 0,\n            y: 0,\n            z: 0\n          }\n        }\n      ]);\n    }\n\n    if (noGeometries && !attrs.loaders) {\n      this.geometries.add([\n        {\n          type: 'box',\n          name: 'defaultbox',\n          position: {\n            x: 0,\n            y: 0,\n            z: 0\n          }\n        }\n      ]);\n    }\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/threejs/state.js\n// module id = 158\n// module chunks = 4 6","'use strict';\nvar LayerState = require('./../state');\nvar TxtLayerState = LayerState.types.txt = LayerState.extend({\n  baseParameters: [\n    {name: 'text', type: 'string', default: ''}\n  ].concat(LayerState.prototype.baseParameters),\n\n  derived: {\n    text: {\n      deps: ['parameters.text'],\n      fn: function() {\n        return this.parameters.getValue('text');\n      }\n    }\n  }\n});\nmodule.exports = TxtLayerState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/txt/state.js\n// module id = 159\n// module chunks = 4 6","'use strict';\nvar ScreenLayerState = require('./../state');\nmodule.exports = ScreenLayerState.types.video = ScreenLayerState.extend({\n  baseParameters: [\n    {name: 'src', type: 'string', default: ''}\n  ].concat(ScreenLayerState.prototype.baseParameters),\n\n  derived: {\n    src: {\n      deps: ['parameters.src'],\n      fn: function() {\n        return this.parameters.getValue('src');\n      }\n    }\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/video/state.js\n// module id = 160\n// module chunks = 4 6","'use strict';\n\nfunction isCollectionOfParent(o, p) {\n  if (!p || !p._collections) return;\n  for (var name in p._collections) {\n    if (p[name] === o.collection) return name + '.' + o.getId();\n  }\n}\n\nfunction isChildOfParent(o, p) {\n  if (!p || !p._children) return;\n  for (var name in p._children) {\n    if (p[name] === o) return name;\n  }\n}\n\nfunction isPropOfParent(o, p) {\n  if (!p) return;\n  for (var name in p) {\n    if (p[name] === o) return name;\n  }\n}\n\nvar _paths = {};\nfunction objectPath(state) {\n  if (!state) return null;\n  if (_paths[state.cid]) return _paths[state.cid];\n  var parts = [];\n\n\n  function up(instance) {\n    var collectionName = instance.collection ?\n                          isCollectionOfParent(instance, instance.collection.parent) :\n                          null;\n    if (collectionName) {\n      parts.unshift(collectionName);\n      return up(instance.collection.parent);\n    }\n\n    var childName = isChildOfParent(instance, instance.parent);\n    if (childName) {\n      parts.unshift(childName);\n      return up(instance.parent);\n    }\n\n\n    var propName = isPropOfParent(instance, instance.parent);\n    if (propName) {\n      parts.unshift(propName);\n      return up(instance.parent);\n    }\n\n    if (instance.parent) up(instance.parent);\n  }\n\n  up(state);\n\n  _paths[state.cid] = parts.join('.');\n  return _paths[state.cid];\n}\n\nmodule.exports = objectPath;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./utils/object-path.js\n// module id = 347\n// module chunks = 4 6","'use strict';\nvar ParamState = require('./state');\nvar Collection = require('ampersand-collection');\n\nvar ParamCollection = Collection.extend({\n  mainIndex: 'name',\n  model: ParamState,\n\n  comparator: 'name',\n\n  toJSON: function (...args) {\n    return this.map(model => model.toJSON(...args));\n  },\n\n  getValue: function(name, defaultVal) {\n    var param = this.get(name);\n    if (!param) return defaultVal;\n    var val = param.value;\n    defaultVal = arguments.length === 2 ? defaultVal : param.default;\n    return val === null || typeof val === 'undefined' ? defaultVal : val;\n  }\n});\n\nmodule.exports = ParamCollection;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parameter/collection.js\n// module id = 349\n// module chunks = 4 6","'use strict';\nvar noop = function(){};\nvar mockedCtx = {\n  save: noop,\n  restore: noop,\n  scale: noop,\n  rotate: noop,\n  translate: noop,\n  transform: noop,\n  setTransform: noop,\n  resetTransform: noop,\n  createLinearGradient: noop,\n  createRadialGradient: noop,\n  createPattern: noop,\n  clearRect: noop,\n  fillRect: noop,\n  strokeRect: noop,\n  beginPath: noop,\n  fill: noop,\n  stroke: noop,\n  drawFocusIfNeeded: noop,\n  clip: noop,\n  isPointInPath: noop,\n  isPointInStroke: noop,\n  fillText: noop,\n  strokeText: noop,\n  measureText: noop,\n  drawImage: noop,\n  createImageData: noop,\n  getImageData: noop,\n  putImageData: noop,\n  getContextAttributes: noop,\n  setLineDash: noop,\n  getLineDash: noop,\n  closePath: noop,\n  moveTo: noop,\n  lineTo: noop,\n  quadraticCurveTo: noop,\n  bezierCurveTo: noop,\n  arcTo: noop,\n  rect: noop,\n  arc: noop,\n  ellipse: noop,\n  // properties\n  globalAlpha: 1,\n  globalCompositeOperation: 'source-over',\n  filter: 'none',\n  imageSmoothingEnabled: true,\n  imageSmoothingQuality: 'low',\n  strokeStyle: '#000000',\n  fillStyle: '#000000',\n  shadowOffsetX: 0,\n  shadowOffsetY: 0,\n  shadowBlur: 0,\n  shadowColor: 'rgba(0, 0, 0, 0)',\n  lineWidth: 1,\n  lineCap: 'butt',\n  lineJoin: 'miter',\n  miterLimit: 10,\n  lineDashOffset: 0,\n  font: '10px sans-serif',\n  textAlign: 'start',\n  textBaseline: 'alphabetic',\n  canvas: {width: 400, height: 300},\n  // utilities\n  _: {}\n};\nmockedCtx._.methods = Object.keys(mockedCtx)\n  .filter(function(name) {\n    return typeof mockedCtx[name] === 'function';\n  });\nmockedCtx._.properties = Object.keys(mockedCtx)\n  .filter(function(name) {\n    return name != '_' && typeof mockedCtx[name] !== 'function';\n  });\nmodule.exports = mockedCtx;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/mocked-canvas-2d-context.js\n// module id = 350\n// module chunks = 4 6","'use strict';\nmodule.exports = function minMax(val, min = 0, max = 16) {\n  return (Math.abs(min - max) * Number(val) * (1 / 127)) - min;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./utils/midi-min-max.js\n// module id = 352\n// module chunks = 4 6","'use strict';\nmodule.exports = function midi2prct(val) {\n  return require('./prct')(val, 127);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./utils/midi2prct.js\n// module id = 353\n// module chunks = 4 6","'use strict';\nmodule.exports = function midi2rad(val) {\n  return Math.PI * 2 * (Number(val) * (1 / 127));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./utils/midi2rad.js\n// module id = 354\n// module chunks = 4 6","'use strict';\n\nfunction noop() {}\n\nvar utils = module.exports = {};\n\nutils.random = function random(multi = 100) {\n  return Math.random() * multi;\n};\n\nutils.between = function between(val, min, max) {\n  return Math.max(min, Math.min(max, val));\n};\n\n\nutils.log = function log(ctx, ...args) {\n  console.info(...args);\n};\n\n\nutils.midiMinMax = require('./../../utils/midi-min-max');\nutils.midi2Rad = require('./../../utils/midi2rad');\nutils.midi2Prct = require('./../../utils/midi2prct');\n\n/**\n * txt\n * @param [text]\n * @param [x]\n * @param [y]\n */\nutils.txt = function txt(ctx, ...args) {\n  var text, x, y;\n  [\n    text = '',\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n  ] = args;\n  ctx.fillText(text, x, y);\n};\n\n/**\n * dot\n * @param [x]\n * @param [y]\n * @param [radius]: 10\n * @param [start]: 0\n * @param [end]: 360\n */\nutils.dot = function dot(ctx, ...args) {\n  var x, y, radius, start, end;\n  [\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n    radius = 10,\n    start = 0,\n    end = Math.PI * 2\n  ] = args;\n  ctx.beginPath();\n  ctx.arc(x, y, radius, start, end);\n  ctx.closePath();\n  ctx.fill();\n};\n\n/**\n * circle\n * @param [x]: <center>\n * @param [y]: <center>\n * @param [radius]: 10\n * @param [start]: 0\n * @param [end]: 360\n */\nutils.circle = function circle(ctx, ...args) {\n  var x, y, radius, start, end;\n  [\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n    radius = 10,\n    start = 0,\n    end = Math.PI * 2\n  ] = args;\n  ctx.beginPath();\n  ctx.arc(x, y, radius, start, end);\n  ctx.closePath();\n  ctx.stroke();\n};\n\n\nutils.line = function line(ctx, ...args) {\n  ctx.beginPath();\n  if (typeof args[0] === 'string') {\n    ctx.strokeStyle = args.shift();\n  }\n  if (typeof args[0] === 'number') {\n    ctx.lineWidth = args.shift();\n  }\n  if (!args.length) return;\n  var point = args.shift();\n  ctx.moveTo(point[0], point[1]);\n  args.forEach(function(point) {\n    ctx.lineTo(point[0], point[1]);\n  });\n  ctx.stroke();\n};\n\n/**\n * polygone\n * @param [x]: <center>\n * @param [y]: <center>\n * @param [size]: 30\n * @param [sides]: 3\n */\nutils.polygone = function polygone(ctx, ...args) {\n  ctx.beginPath();\n  var sides, angle, i, x, y, lx, ly, size;\n  [\n    x,\n    y,\n    size = 30,\n    sides = 3\n  ] = args;\n  var shift = Math.PI * 0.5;\n  var rad = (Math.PI * 2) / sides;\n  for (i = 0; i < sides; i++) {\n    angle = rad * i + shift;\n    lx = Math.round(x + Math.cos(angle) * size);\n    ly = Math.round(y + Math.sin(angle) * size);\n    if (!i) {\n      ctx.beginPath();\n    }\n    ctx.lineTo(lx, ly);\n  }\n\n  ctx.closePath();\n  ctx.stroke();\n};\n\n\nutils.grid = function grid(width, height, itemsCount, rowsCount, process) {\n  process = typeof process === 'function' ? process : noop;\n  var r = 0,\n      c = 0,\n      xy = [0,0],\n      rowHeight = height / rowsCount,\n      columnsCount = itemsCount / rowsCount,\n      columnWidth = width / columnsCount\n  ;\n\n  // var args = [].slice.apply(arguments).map(item => typeof item);\n  // console.info(...args);\n  for (r = 0; r < rowsCount; r++) {\n    for (c = 0; c < columnsCount; c++) {\n      xy[1] = rowHeight * (r + 0.5);\n      xy[0] = columnWidth * (c + 0.5);\n      process(...xy);\n    }\n  }\n};\n\n\n/*\nfunction () {\n  var cx = width / 2;\n  var cy = height / 2;\n  var i = 0;\n  var r;\n  var s = -10;\n  fillStyle('#fff');\n  distribute(cx, cy, 12, cy, (layer.frametime % (360 * s)) / s, function(x, y, a) {\n    r = (cy / 12) * i;\n    fillText(a.toFixed(2), cx + (Math.cos(a) * r), cy + (Math.sin(a) * r));\n    i++;\n  });\n}\n*/\nutils.distribute = function distribute(x, y, itemsCount, r, tilt, process) {\n  itemsCount = itemsCount || 2;\n  tilt = tilt || 0;\n  process = typeof process === 'function' ? process : noop;\n  var i, a, args;\n  var rad = Math.PI * 2;\n  for (i = 0; i < itemsCount; i++) {\n    a = ((rad / itemsCount) * i) - Math.PI + ((rad / 360) * tilt);\n    args = [\n      x + (Math.cos(a) * r),\n      y + (Math.sin(a) * r),\n      a\n    ];\n    process(...args);\n  }\n};\n\n\n\nutils.repeat = function repeat(times, process, ...args) {\n  process = typeof process === 'function' ? process : noop;\n  for (var i = 0; i < times; i++) {\n    process(i, ...args);\n  }\n};\n\n\nutils.cacheContext = function cacheContext(ctx, cache, max) {\n  max = max || 0;\n  if (!max) return;\n\n  var w = ctx.canvas.width;\n  var h = ctx.canvas.height;\n  cache.unshift(ctx.getImageData(0, 0, w, h));\n  if (cache.length >= max) cache.pop();\n};\n\nutils.restoreContexts = function restoreContexts(ctx, cache, count, preprocess, postprocess) {\n  count = count || 1;\n  preprocess = preprocess || noop;\n  postprocess = postprocess || noop;\n  // console.info(cache.length);\n  for (var c = 1; c < count && c < cache.length; c++) {\n    if (cache[c] instanceof ImageData) {\n      try {\n        ctx.putImageData(preprocess(cache[c]), 0, 0);\n        postprocess();\n      }\n      catch (e) {\n        console.info(e.message, cache[c] instanceof ImageData);\n      }\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/canvas-utils.js\n// module id = 355\n// module chunks = 4 6","'use strict';\nvar mockedCtx = require('./mocked-canvas-2d-context');\nvar utils = require('./canvas-utils');// jshint ignore:line\n\n// proxy the method and parameters of the canvas context\nvar ctxProperties = '';\nmockedCtx._.methods\n  .forEach(function(name) {\n    ctxProperties += '\\nvar ' + name + ' = function(...args) { try { ctx.' + name + '(...args); } catch(e){} };';\n  });\nmockedCtx._.properties\n  .forEach(function(name) {\n    if (name !== 'canvas') ctxProperties += '\\nvar ' + name + ' = function(val) { if (val !== undefined) { ctx.' + name + ' = val; } return ctx.' + name + '; };';\n  });\n\nfunction compileFunction(drawFunction) {\n  var fn;// jshint ignore:line\n\n  var evaled = `fn = (function() {\n  // override some stuff that should not be used\n  var navigator, window, global, document, module, exports;\n\n  return function(ctx) {\n    const width = (ctx.canvas || {}).width || 400;\n    const height = (ctx.canvas || {}).height || 300;\n    const layer = this;\n    const store = layer.cache;\n    const frametime = layer ? layer.frametime : 0;\n    const audio = layer ? layer.audio : {};\n    const bufferLength = function() { return ((layer.audio || {}).bufferLength) || 128; };\n    const frequency = function(x) {\n      return ((layer.audio || {}).frequency || [])[x] || 0;\n    };\n    const timeDomain = function(x) {\n      return ((layer.audio || {}).timeDomain || [])[x] || 0;\n    };\n\n    const parameter = function(name, defaultVal) {\n      return layer.parameters.getValue(name, defaultVal);\n    };\n\n    ${ ctxProperties }\n    const random = utils.random;\n    const between = utils.between;\n    const midiMinMax = utils.midiMinMax;\n    const midi2rad = utils.midi2rad;\n    const midi2prct = utils.midi2prct;\n\n    const grid = function(...args) { utils.grid(width, height, ...args); };\n    const distribute = function(...args) { utils.distribute(...args); };\n    const repeat = function(...args) { utils.repeat(...args); };\n    const log = function(...args) { utils.log(ctx, ...args); };\n    const txt = function(...args) { utils.txt(ctx, ...args); };\n    const dot = function(...args) { utils.dot(ctx, ...args); };\n    const circle = function(...args) { utils.circle(ctx, ...args); };\n    const polygone = function(...args) { utils.polygone(ctx, ...args); };\n    const line = function(...args) { utils.line(ctx, ...args); };\n    const cacheContext = function(...args) { utils.cacheContext(ctx, ...args); };\n    const restoreContexts = function(...args) { utils.restoreContexts(ctx, ...args); };\n\n\n    return (${ drawFunction.toString() })(ctx);\n  };\n})();`;\n  eval(evaled);// jshint ignore:line\n  return fn;\n}\n\nmodule.exports = compileFunction;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/compile-draw-function.js\n// module id = 356\n// module chunks = 4 6","'use strict';\nvar State = require('ampersand-state');\n\nvar Extractor = State.extend({\n  autoRender: true,\n  template: '<div style=\"display: none\"></div>',\n\n  extractStyles: function() {\n    var styles = {};\n    var existingStyles = this.model.svgStyles || {};\n\n    this.svg.querySelectorAll('[style][id]').forEach(function(styledEl) {\n      styles['#' + styledEl.id] = existingStyles['#' + styledEl.id] || styledEl.getAttribute('style');\n      styledEl.style = null;\n    });\n\n    return styles;\n  },\n\n  removeStylesFromContent: function() {\n    this.svg.querySelectorAll('[style][id]').forEach(function(styledEl) {\n      styledEl.style = null;\n    });\n    return this;\n  },\n\n  setPathLengths: function() {\n    var paths = this.el.querySelectorAll('path');\n    for (var p = 0; p < paths.length; p++) {\n      paths[p].style.setProperty('--path-length', paths[p].getTotalLength());\n    }\n    return this;\n  },\n\n  extractProps: function() {\n    var props = [];\n    var name, value;\n\n    for (var p = 0; p < this.svg.style.length; p++) {\n      name = this.svg.style[p].slice(2);\n      value = this.svg.style.getPropertyValue(name).trim();\n      props.push({\n        name: name,\n        value: value,\n        default: value\n      });\n    }\n\n    this.svg.style = null;\n\n    var previousParameters = this.model.parameters.serialize();\n    return props.concat(previousParameters);\n  },\n\n  extract: function() {\n    if (!this.el || this.el.innerHTML === this.model.content) return;\n    this.el.innerHTML = this.model.content;\n\n    this.svg = this.el.querySelector('svg');\n    if (!this.svg) return;\n    var svgState = this.model;\n\n    var layer = {};\n    layer[svgState.idAttribute] = svgState.getId();\n\n    layer.svgStyles = Object.keys(svgState.svgStyles).length ? this.removeStylesFromContent().model.svgStyles : this.extractStyles();\n\n    this.model.parameters.set(this.setPathLengths().extractProps());\n    layer.parameters = this.model.parameters.serialize();\n\n    layer.content = this.el.innerHTML;\n\n    svgState.once('change:svgStyles', function() { svgState.trigger('svg:extracted'); });\n    svgState.trigger('sendCommand', 'updateLayer', {layer: layer, broadcast: true});\n\n    svgState.set('content', layer.content, {silent: true});\n\n    return this;\n  },\n\n  initialize: function(options) {\n    this.model = options.model;\n    this.el = document.createElement('div');\n    this.listenToAndRun(this.model, 'change:content', this.extract);\n  }\n});\nmodule.exports = Extractor;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/svg/extractor.js\n// module id = 357\n// module chunks = 4 6","'use strict';\nvar State = require('ampersand-state');\nvar objectPath = require('./../utils/object-path');\n\nvar ParamState = State.extend({\n  idAttribute: 'name',\n\n  mappable: {\n    target: ['value']\n  },\n\n  props: {\n    name: ['string', true, ''],\n    type: ['string', false, ''],\n    value: ['any', false, ''],\n    default: ['any', false, '']\n  },\n\n  derived: {\n    modelPath: {\n      deps: ['name'],\n      fn: function() {\n        return objectPath(this);\n      }\n    }\n  }\n});\n\nmodule.exports = ParamState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parameter/state.js\n// module id = 358\n// module chunks = 4 6","'use strict';\nmodule.exports = function prct(val, max = 255) {\n  if (!val || !max) return 0;\n  return (100 / max) * Number(val);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./utils/prct.js\n// module id = 359\n// module chunks = 4 6"],"sourceRoot":""}